import{S as Be,i as Ce,s as De,e as k,k as J,j as Z,c as y,a as p,d as u,n as P,m as ee,b as r,f as x,G as h,o as te,x as B,u as F,v as se,w as le,D as O,E as U,H as re,I as Ne,X as Te,t as de,g as he,K as me,r as ie,L as H,ap as Se}from"../../chunks/vendor-911147da.js";import{c as R,d as X}from"../../chunks/store-cc46ed4c.js";import Ie from"./NoteBody.svelte-68fc44ff.js";import Ve from"./TitleForm.svelte-446fdf32.js";import Oe from"./TitleContent.svelte-39cbcf5b.js";import Ue from"./OurButtons.svelte-03b5ddb2.js";import{g as ne}from"../../chunks/navigation-51b348a1.js";import"./CodeContent.svelte-9172a0b3.js";import"../../chunks/preload-helper-ec9aa979.js";import"./CodeForm.svelte-5c3bf483.js";import"./DescriptionForm.svelte-2ec06f36.js";import"./DescriptionContent.svelte-bf7eb22e.js";import"../../chunks/index-f86ce38b.js";/* empty css                                                           */import"../../chunks/singletons-ff603286.js";function pe(o,e,s){const t=o.slice();return t[23]=e[s],t[25]=s,t}function ve(o){let e,s,t,l,i,n,a,d,z,I,L,M,C,K,A,f,b,D,m,j,_=o[5][o[0]].edit&&_e(o),g=!o[5][o[0]].edit&&ge(o),G=o[5][o[0]].steps,w=[];for(let c=0;c<G.length;c+=1)w[c]=be(pe(o,G,c));const je=c=>F(w[c],1,1,()=>{w[c]=null});let q=!Me;C=new Ue({props:{i:o[0]}});let N=!o[4].save&&!o[4].update&&we(o),T=o[4].save&&o[5][o[0]].mode==="draft"&&ke(o),V=o[4].save&&o[5][o[0]].mode==="publish"&&ye(),S=o[4].update&&o[5][o[0]].mode==="publish"&&Ee(o);return{c(){e=k("div"),s=k("div"),t=k("div"),l=k("div"),_&&_.c(),i=J(),n=k("div"),g&&g.c(),a=J(),d=k("div"),z=k("ol");for(let c=0;c<w.length;c+=1)w[c].c();I=J(),q&&q.c(),L=J(),M=k("div"),Z(C.$$.fragment),K=J(),A=k("div"),f=k("div"),N&&N.c(),b=J(),T&&T.c(),D=J(),V&&V.c(),m=J(),S&&S.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var v=p(e);s=y(v,"DIV",{class:!0});var Q=p(s);t=y(Q,"DIV",{class:!0});var E=p(t);l=y(E,"DIV",{class:!0});var W=p(l);_&&_.l(W),W.forEach(u),i=P(E),n=y(E,"DIV",{class:!0});var ae=p(n);g&&g.l(ae),ae.forEach(u),E.forEach(u),Q.forEach(u),a=P(v),d=y(v,"DIV",{class:!0});var Y=p(d);z=y(Y,"OL",{class:!0});var ce=p(z);for(let oe=0;oe<w.length;oe+=1)w[oe].l(ce);ce.forEach(u),I=P(Y),q&&q.l(Y),Y.forEach(u),L=P(v),M=y(v,"DIV",{class:!0});var ue=p(M);ee(C.$$.fragment,ue),ue.forEach(u),K=P(v),A=y(v,"DIV",{class:!0});var fe=p(A);f=y(fe,"DIV",{id:!0});var $=p(f);N&&N.l($),b=P($),T&&T.l($),D=P($),V&&V.l($),m=P($),S&&S.l($),$.forEach(u),fe.forEach(u),v.forEach(u),this.h()},h(){r(l,"class","title__form-div"),r(n,"class","title__content-div"),r(t,"class","note-title__title"),r(s,"class","note-title"),r(z,"class","list-decimal"),r(d,"class","note-body"),r(M,"class","note-footer"),r(f,"id","add-btn"),r(A,"class","bottom-bar md:pl-64"),r(e,"class","app-wrapper svelte-18ehxgn")},m(c,v){x(c,e,v),h(e,s),h(s,t),h(t,l),_&&_.m(l,null),h(t,i),h(t,n),g&&g.m(n,null),h(e,a),h(e,d),h(d,z);for(let Q=0;Q<w.length;Q+=1)w[Q].m(z,null);h(d,I),q&&q.m(d,null),h(e,L),h(e,M),te(C,M,null),h(e,K),h(e,A),h(A,f),N&&N.m(f,null),h(f,b),T&&T.m(f,null),h(f,D),V&&V.m(f,null),h(f,m),S&&S.m(f,null),j=!0},p(c,v){if(c[5][c[0]].edit?_?(_.p(c,v),v&33&&B(_,1)):(_=_e(c),_.c(),B(_,1),_.m(l,null)):_&&(ie(),F(_,1,1,()=>{_=null}),le()),c[5][c[0]].edit?g&&(ie(),F(g,1,1,()=>{g=null}),le()):g?(g.p(c,v),v&33&&B(g,1)):(g=ge(c),g.c(),B(g,1),g.m(n,null)),v&33){G=c[5][c[0]].steps;let E;for(E=0;E<G.length;E+=1){const W=pe(c,G,E);w[E]?(w[E].p(W,v),B(w[E],1)):(w[E]=be(W),w[E].c(),B(w[E],1),w[E].m(z,null))}for(ie(),E=G.length;E<w.length;E+=1)je(E);le()}const Q={};v&1&&(Q.i=c[0]),C.$set(Q),!c[4].save&&!c[4].update?N?N.p(c,v):(N=we(c),N.c(),N.m(f,b)):N&&(N.d(1),N=null),c[4].save&&c[5][c[0]].mode==="draft"?T?T.p(c,v):(T=ke(c),T.c(),T.m(f,D)):T&&(T.d(1),T=null),c[4].save&&c[5][c[0]].mode==="publish"?V||(V=ye(),V.c(),V.m(f,m)):V&&(V.d(1),V=null),c[4].update&&c[5][c[0]].mode==="publish"?S?S.p(c,v):(S=Ee(c),S.c(),S.m(f,null)):S&&(S.d(1),S=null)},i(c){if(!j){B(_),B(g);for(let v=0;v<G.length;v+=1)B(w[v]);B(q),B(C.$$.fragment,c),j=!0}},o(c){F(_),F(g),w=w.filter(Boolean);for(let v=0;v<w.length;v+=1)F(w[v]);F(q),F(C.$$.fragment,c),j=!1},d(c){c&&u(e),_&&_.d(),g&&g.d(),Te(w,c),q&&q.d(),se(C),N&&N.d(),T&&T.d(),V&&V.d(),S&&S.d()}}}function _e(o){let e,s;return e=new Ve({props:{i:o[0]}}),{c(){Z(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),s=!0},p(t,l){const i={};l&1&&(i.i=t[0]),e.$set(i)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){F(e.$$.fragment,t),s=!1},d(t){se(e,t)}}}function ge(o){let e,s;return e=new Oe({props:{i:o[0]}}),{c(){Z(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),s=!0},p(t,l){const i={};l&1&&(i.i=t[0]),e.$set(i)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){F(e.$$.fragment,t),s=!1},d(t){se(e,t)}}}function be(o){let e,s,t,l;return s=new Ie({props:{i:o[0],ii:o[25]}}),{c(){e=k("li"),Z(s.$$.fragment),t=J(),this.h()},l(i){e=y(i,"LI",{class:!0});var n=p(e);ee(s.$$.fragment,n),t=P(n),n.forEach(u),this.h()},h(){r(e,"class","mb-5")},m(i,n){x(i,e,n),te(s,e,null),h(e,t),l=!0},p(i,n){const a={};n&1&&(a.i=i[0]),s.$set(a)},i(i){l||(B(s.$$.fragment,i),l=!0)},o(i){F(s.$$.fragment,i),l=!1},d(i){i&&u(e),se(s)}}}function we(o){let e,s,t,l,i;return{c(){e=k("button"),s=O("svg"),t=O("path"),this.h()},l(n){e=y(n,"BUTTON",{class:!0});var a=p(e);s=U(a,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var d=p(s);t=U(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(t).forEach(u),d.forEach(u),a.forEach(u),this.h()},h(){r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),r(s,"xmlns","http://www.w3.org/2000/svg"),r(s,"class","h-8 w-8"),r(s,"fill","none"),r(s,"viewBox","0 0 24 24"),r(s,"stroke","currentColor"),r(e,"class","text-white rounded-full h-14 w-14 bg-pink-700 grid place-items-center")},m(n,a){x(n,e,a),h(e,s),h(s,t),l||(i=re(e,"click",o[6]),l=!0)},p:Ne,d(n){n&&u(e),l=!1,i()}}}function ke(o){let e,s,t;function l(a,d){return a[2]?xe:ze}let i=l(o),n=i(o);return{c(){e=k("button"),n.c(),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var d=p(e);n.l(d),d.forEach(u),this.h()},h(){r(e,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(a,d){x(a,e,d),n.m(e,null),s||(t=re(e,"click",o[7]),s=!0)},p(a,d){i!==(i=l(a))&&(n.d(1),n=i(a),n&&(n.c(),n.m(e,null)))},d(a){a&&u(e),n.d(),s=!1,t()}}}function ze(o){let e,s;return{c(){e=O("svg"),s=O("path"),this.h()},l(t){e=U(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=p(e);s=U(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(s).forEach(u),l.forEach(u),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"class","h-8 w-8"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"stroke","currentColor")},m(t,l){x(t,e,l),h(e,s)},d(t){t&&u(e)}}}function xe(o){let e,s,t;return{c(){e=O("svg"),s=O("circle"),t=O("path"),this.h()},l(l){e=U(l,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var i=p(e);s=U(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(s).forEach(u),t=U(i,"path",{class:!0,fill:!0,d:!0}),p(t).forEach(u),i.forEach(u),this.h()},h(){r(s,"class","opacity-25"),r(s,"cx","12"),r(s,"cy","12"),r(s,"r","10"),r(s,"stroke","currentColor"),r(s,"stroke-width","4"),r(t,"class","opacity-75"),r(t,"fill","currentColor"),r(t,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(e,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24")},m(l,i){x(l,e,i),h(e,s),h(e,t)},d(l){l&&u(e)}}}function ye(o){let e,s,t,l;return{c(){e=k("button"),s=O("svg"),t=O("circle"),l=O("path"),this.h()},l(i){e=y(i,"BUTTON",{class:!0});var n=p(e);s=U(n,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var a=p(s);t=U(a,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(t).forEach(u),l=U(a,"path",{class:!0,fill:!0,d:!0}),p(l).forEach(u),a.forEach(u),n.forEach(u),this.h()},h(){r(t,"class","opacity-25"),r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(t,"stroke","currentColor"),r(t,"stroke-width","4"),r(l,"class","opacity-75"),r(l,"fill","currentColor"),r(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(s,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(s,"xmlns","http://www.w3.org/2000/svg"),r(s,"fill","none"),r(s,"viewBox","0 0 24 24"),r(e,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(i,n){x(i,e,n),h(e,s),h(s,t),h(s,l)},d(i){i&&u(e)}}}function Ee(o){let e,s,t;function l(a,d){return a[3]?He:Fe}let i=l(o),n=i(o);return{c(){e=k("button"),n.c(),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var d=p(e);n.l(d),d.forEach(u),this.h()},h(){r(e,"class","text-white rounded-full h-14 w-14 bg-blue-700 grid place-items-center")},m(a,d){x(a,e,d),n.m(e,null),s||(t=re(e,"click",o[8]),s=!0)},p(a,d){i!==(i=l(a))&&(n.d(1),n=i(a),n&&(n.c(),n.m(e,null)))},d(a){a&&u(e),n.d(),s=!1,t()}}}function Fe(o){let e,s;return{c(){e=O("svg"),s=O("path"),this.h()},l(t){e=U(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=p(e);s=U(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(s).forEach(u),l.forEach(u),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"class","h-8 w-8"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"stroke","currentColor")},m(t,l){x(t,e,l),h(e,s)},d(t){t&&u(e)}}}function He(o){let e,s,t;return{c(){e=O("svg"),s=O("circle"),t=O("path"),this.h()},l(l){e=U(l,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var i=p(e);s=U(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(s).forEach(u),t=U(i,"path",{class:!0,fill:!0,d:!0}),p(t).forEach(u),i.forEach(u),this.h()},h(){r(s,"class","opacity-25"),r(s,"cx","12"),r(s,"cy","12"),r(s,"r","10"),r(s,"stroke","currentColor"),r(s,"stroke-width","4"),r(t,"class","opacity-75"),r(t,"fill","currentColor"),r(t,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(e,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24")},m(l,i){x(l,e,i),h(e,s),h(e,t)},d(l){l&&u(e)}}}function Le(o){let e,s,t,l,i,n,a,d,z,I,L,M,C,K,A,f=o[5][o[0]]&&ve(o);return{c(){e=k("div"),s=k("h3"),t=de("Code Notes"),l=J(),i=k("div"),n=k("div"),a=k("div"),d=k("input"),z=J(),I=k("button"),L=de("Submit"),M=J(),f&&f.c(),this.h()},l(b){e=y(b,"DIV",{class:!0});var D=p(e);s=y(D,"H3",{class:!0});var m=p(s);t=he(m,"Code Notes"),m.forEach(u),D.forEach(u),l=P(b),i=y(b,"DIV",{class:!0});var j=p(i);n=y(j,"DIV",{class:!0});var _=p(n);a=y(_,"DIV",{class:!0});var g=p(a);d=y(g,"INPUT",{type:!0}),z=P(g),I=y(g,"BUTTON",{class:!0});var G=p(I);L=he(G,"Submit"),G.forEach(u),g.forEach(u),M=P(_),f&&f.l(_),_.forEach(u),j.forEach(u),this.h()},h(){r(s,"class","ml-10"),r(e,"class","fixed inset-x-0 p-2 md:p-4 bg-gray-700 md:top-0 top-14 text-white text-lg md:pl-64 z-10"),r(d,"type","file"),r(I,"class","px-4 py-2 bg-indigo-200 text-indigo-900 hover:bg-indigo-300 transition"),r(a,"class","border-4 border-dotted border-indigo-200 p-6 rounded-lg"),r(n,"class","container mx-auto max-w-screen-md "),r(i,"class","section md:mt-8 mt-12")},m(b,D){x(b,e,D),h(e,s),h(s,t),x(b,l,D),x(b,i,D),h(i,n),h(n,a),h(a,d),o[13](d),h(a,z),h(a,I),h(I,L),h(n,M),f&&f.m(n,null),C=!0,K||(A=re(I,"click",o[9]),K=!0)},p(b,[D]){b[5][b[0]]?f?(f.p(b,D),D&33&&B(f,1)):(f=ve(b),f.c(),B(f,1),f.m(n,null)):f&&(ie(),F(f,1,1,()=>{f=null}),le())},i(b){C||(B(f),C=!0)},o(b){F(f),C=!1},d(b){b&&u(e),b&&u(l),b&&u(i),o[13](null),f&&f.d(),K=!1,A()}}}async function lt({page:o,fetch:e,session:s}){if(!s)return{status:302,redirect:"/auth"};let t=o.params.index,l=t.split("-"),i=+l[0];+l[1];let n;if(l.length>1){const a=await e(`/code/${t}.json`),d=await a.json();n=JSON.parse(d.string),a.status===200}return{props:{i,session:s,post:n,slug:t}}}let Me=!0;function Je(o,e,s){let t,l;me(o,X,m=>s(4,t=m)),me(o,R,m=>s(5,l=m));let{i=0}=e,{post:n}=e,{slug:a}=e,d,z=!1,I=!1,{session:L}=e;function M(){l[i]===void 0&&n!==void 0?H(R,l[i]=n,l):l[i]?console.log("new"):(console.log("ELSING"),browser&&ne("/code",{invalidate:!0}))}M();function C(){H(X,t.update=!1,t),l.forEach(m=>{m.edit=!1,m.steps.length>0&&m.steps.forEach(j=>{j.editDesc=!1,j.editCode=!1})})}function K(){let m={title:"",steps:[],edit:!0,ready:!0,mode:"draft"};H(R,l=[...l,m],l),H(X,t.showFabs=!0,t),H(X,t.save=!0,t),H(X,t.edit=!1,t);let j=l.length-1;ne("/code/"+j)}async function A(){s(2,z=!0),H(X,t.update=!1,t),H(R,l[i].mode="publish",l);let m=l[i],j={title:l[i].title,string:JSON.stringify(m),status:"publish",author:L.id};const g=await(await fetch(`/code/${a}}.json`,{method:"POST",body:JSON.stringify(j)})).json();setTimeout(()=>{C(),H(R,l.ready=!0,l),H(X,t.save=!1,t),H(X,t.update=!1,t),ne(`/code/${i}-${g.body.id}`,{replaceState:!0})},2001)}async function f(){s(3,I=!0),H(R,l[i].mode="publish",l);let m=l[i],j={title:l[i].title,string:JSON.stringify(m),status:"publish",author:L.id};console.log(l[i].id),await(await fetch(`/code/${l[i].id}.json`,{method:"PUT",body:JSON.stringify(j)})).json(),s(3,I=!1),H(X,t.update=!1,t)}t.save||C();async function b(){const m=new FormData;m.append("file",d.files[0]);try{const j=await fetch("/code/media/upload",{method:"POST",body:m})}catch(j){console.error(j)}}function D(m){Se[m?"unshift":"push"](()=>{d=m,s(1,d)})}return o.$$set=m=>{"i"in m&&s(0,i=m.i),"post"in m&&s(10,n=m.post),"slug"in m&&s(11,a=m.slug),"session"in m&&s(12,L=m.session)},o.$$.update=()=>{o.$$.dirty&2},[i,d,z,I,t,l,K,A,f,b,n,a,L,D]}class rt extends Be{constructor(e){super();Ce(this,e,Je,Le,De,{i:0,post:10,slug:11,session:12})}}export{rt as default,lt as load};
