import{S as Be,i as Ce,s as Se,e as k,k as J,j as $,c as y,a as p,d as u,n as P,m as ee,b as r,f as L,G as m,o as te,x as B,u as M,v as se,w as le,D as V,E as U,H as re,I as Ne,X as De,t as de,g as he,K as me,A as Te,r as ie,L as x,ap as Ie}from"../../chunks/vendor-52b416c4.js";import{c as W,d as X}from"../../chunks/store-18dbc89f.js";import Oe from"./NoteBody.svelte-088853ff.js";import Ve from"./TitleForm.svelte-80959ad0.js";import Ue from"./TitleContent.svelte-d605ce40.js";import ze from"./OurButtons.svelte-b3ae2b8c.js";import{g as ne}from"../../chunks/navigation-51b348a1.js";import{p as Le}from"../../chunks/offline-45ec2525.js";import"./CodeContent.svelte-2ac324cb.js";import"../../chunks/preload-helper-ec9aa979.js";import"./CodeForm.svelte-d01338bd.js";import"./DescriptionForm.svelte-9b95a921.js";import"./DescriptionContent.svelte-28241d0c.js";import"../../chunks/index-4a09887f.js";/* empty css                                                           */import"../../chunks/singletons-ff603286.js";function pe(n,e,s){const t=n.slice();return t[23]=e[s],t[25]=s,t}function ve(n){let e,s,t,l,i,o,a,d,z,I,F,H,C,K,A,f,b,S,h,E,_=n[4][n[0]].edit&&_e(n),g=!n[4][n[0]].edit&&ge(n),G=n[4][n[0]].steps,w=[];for(let c=0;c<G.length;c+=1)w[c]=be(pe(n,G,c));const je=c=>M(w[c],1,1,()=>{w[c]=null});let q=!Pe;C=new ze({props:{i:n[0]}});let N=!n[5].save&&!n[5].update&&we(n),D=n[5].save&&n[4][n[0]].mode==="draft"&&ke(n),O=n[5].save&&n[4][n[0]].mode==="publish"&&ye(),T=n[5].update&&n[4][n[0]].mode==="publish"&&Ee(n);return{c(){e=k("div"),s=k("div"),t=k("div"),l=k("div"),_&&_.c(),i=J(),o=k("div"),g&&g.c(),a=J(),d=k("div"),z=k("ol");for(let c=0;c<w.length;c+=1)w[c].c();I=J(),q&&q.c(),F=J(),H=k("div"),$(C.$$.fragment),K=J(),A=k("div"),f=k("div"),N&&N.c(),b=J(),D&&D.c(),S=J(),O&&O.c(),h=J(),T&&T.c(),this.h()},l(c){e=y(c,"DIV",{class:!0});var v=p(e);s=y(v,"DIV",{class:!0});var Q=p(s);t=y(Q,"DIV",{class:!0});var j=p(t);l=y(j,"DIV",{class:!0});var Y=p(l);_&&_.l(Y),Y.forEach(u),i=P(j),o=y(j,"DIV",{class:!0});var ae=p(o);g&&g.l(ae),ae.forEach(u),j.forEach(u),Q.forEach(u),a=P(v),d=y(v,"DIV",{class:!0});var Z=p(d);z=y(Z,"OL",{class:!0});var ce=p(z);for(let oe=0;oe<w.length;oe+=1)w[oe].l(ce);ce.forEach(u),I=P(Z),q&&q.l(Z),Z.forEach(u),F=P(v),H=y(v,"DIV",{class:!0});var ue=p(H);ee(C.$$.fragment,ue),ue.forEach(u),K=P(v),A=y(v,"DIV",{class:!0});var fe=p(A);f=y(fe,"DIV",{id:!0});var R=p(f);N&&N.l(R),b=P(R),D&&D.l(R),S=P(R),O&&O.l(R),h=P(R),T&&T.l(R),R.forEach(u),fe.forEach(u),v.forEach(u),this.h()},h(){r(l,"class","title__form-div"),r(o,"class","title__content-div"),r(t,"class","note-title__title"),r(s,"class","note-title"),r(z,"class","list-decimal"),r(d,"class","note-body"),r(H,"class","note-footer"),r(f,"id","add-btn"),r(A,"class","bottom-bar md:pl-64"),r(e,"class","app-wrapper svelte-18ehxgn")},m(c,v){L(c,e,v),m(e,s),m(s,t),m(t,l),_&&_.m(l,null),m(t,i),m(t,o),g&&g.m(o,null),m(e,a),m(e,d),m(d,z);for(let Q=0;Q<w.length;Q+=1)w[Q].m(z,null);m(d,I),q&&q.m(d,null),m(e,F),m(e,H),te(C,H,null),m(e,K),m(e,A),m(A,f),N&&N.m(f,null),m(f,b),D&&D.m(f,null),m(f,S),O&&O.m(f,null),m(f,h),T&&T.m(f,null),E=!0},p(c,v){if(c[4][c[0]].edit?_?(_.p(c,v),v&17&&B(_,1)):(_=_e(c),_.c(),B(_,1),_.m(l,null)):_&&(ie(),M(_,1,1,()=>{_=null}),le()),c[4][c[0]].edit?g&&(ie(),M(g,1,1,()=>{g=null}),le()):g?(g.p(c,v),v&17&&B(g,1)):(g=ge(c),g.c(),B(g,1),g.m(o,null)),v&17){G=c[4][c[0]].steps;let j;for(j=0;j<G.length;j+=1){const Y=pe(c,G,j);w[j]?(w[j].p(Y,v),B(w[j],1)):(w[j]=be(Y),w[j].c(),B(w[j],1),w[j].m(z,null))}for(ie(),j=G.length;j<w.length;j+=1)je(j);le()}const Q={};v&1&&(Q.i=c[0]),C.$set(Q),!c[5].save&&!c[5].update?N?N.p(c,v):(N=we(c),N.c(),N.m(f,b)):N&&(N.d(1),N=null),c[5].save&&c[4][c[0]].mode==="draft"?D?D.p(c,v):(D=ke(c),D.c(),D.m(f,S)):D&&(D.d(1),D=null),c[5].save&&c[4][c[0]].mode==="publish"?O||(O=ye(),O.c(),O.m(f,h)):O&&(O.d(1),O=null),c[5].update&&c[4][c[0]].mode==="publish"?T?T.p(c,v):(T=Ee(c),T.c(),T.m(f,null)):T&&(T.d(1),T=null)},i(c){if(!E){B(_),B(g);for(let v=0;v<G.length;v+=1)B(w[v]);B(q),B(C.$$.fragment,c),E=!0}},o(c){M(_),M(g),w=w.filter(Boolean);for(let v=0;v<w.length;v+=1)M(w[v]);M(q),M(C.$$.fragment,c),E=!1},d(c){c&&u(e),_&&_.d(),g&&g.d(),De(w,c),q&&q.d(),se(C),N&&N.d(),D&&D.d(),O&&O.d(),T&&T.d()}}}function _e(n){let e,s;return e=new Ve({props:{i:n[0]}}),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),s=!0},p(t,l){const i={};l&1&&(i.i=t[0]),e.$set(i)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){M(e.$$.fragment,t),s=!1},d(t){se(e,t)}}}function ge(n){let e,s;return e=new Ue({props:{i:n[0]}}),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),s=!0},p(t,l){const i={};l&1&&(i.i=t[0]),e.$set(i)},i(t){s||(B(e.$$.fragment,t),s=!0)},o(t){M(e.$$.fragment,t),s=!1},d(t){se(e,t)}}}function be(n){let e,s,t,l;return s=new Oe({props:{i:n[0],ii:n[25]}}),{c(){e=k("li"),$(s.$$.fragment),t=J(),this.h()},l(i){e=y(i,"LI",{class:!0});var o=p(e);ee(s.$$.fragment,o),t=P(o),o.forEach(u),this.h()},h(){r(e,"class","mb-5")},m(i,o){L(i,e,o),te(s,e,null),m(e,t),l=!0},p(i,o){const a={};o&1&&(a.i=i[0]),s.$set(a)},i(i){l||(B(s.$$.fragment,i),l=!0)},o(i){M(s.$$.fragment,i),l=!1},d(i){i&&u(e),se(s)}}}function we(n){let e,s,t,l,i;return{c(){e=k("button"),s=V("svg"),t=V("path"),this.h()},l(o){e=y(o,"BUTTON",{class:!0});var a=p(e);s=U(a,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var d=p(s);t=U(d,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(t).forEach(u),d.forEach(u),a.forEach(u),this.h()},h(){r(t,"stroke-linecap","round"),r(t,"stroke-linejoin","round"),r(t,"stroke-width","2"),r(t,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),r(s,"xmlns","http://www.w3.org/2000/svg"),r(s,"class","h-8 w-8"),r(s,"fill","none"),r(s,"viewBox","0 0 24 24"),r(s,"stroke","currentColor"),r(e,"class","text-white rounded-full h-14 w-14 bg-pink-700 grid place-items-center")},m(o,a){L(o,e,a),m(e,s),m(s,t),l||(i=re(e,"click",n[6]),l=!0)},p:Ne,d(o){o&&u(e),l=!1,i()}}}function ke(n){let e,s,t;function l(a,d){return a[2]?xe:Me}let i=l(n),o=i(n);return{c(){e=k("button"),o.c(),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var d=p(e);o.l(d),d.forEach(u),this.h()},h(){r(e,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(a,d){L(a,e,d),o.m(e,null),s||(t=re(e,"click",n[7]),s=!0)},p(a,d){i!==(i=l(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null)))},d(a){a&&u(e),o.d(),s=!1,t()}}}function Me(n){let e,s;return{c(){e=V("svg"),s=V("path"),this.h()},l(t){e=U(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=p(e);s=U(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(s).forEach(u),l.forEach(u),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"class","h-8 w-8"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"stroke","currentColor")},m(t,l){L(t,e,l),m(e,s)},d(t){t&&u(e)}}}function xe(n){let e,s,t;return{c(){e=V("svg"),s=V("circle"),t=V("path"),this.h()},l(l){e=U(l,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var i=p(e);s=U(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(s).forEach(u),t=U(i,"path",{class:!0,fill:!0,d:!0}),p(t).forEach(u),i.forEach(u),this.h()},h(){r(s,"class","opacity-25"),r(s,"cx","12"),r(s,"cy","12"),r(s,"r","10"),r(s,"stroke","currentColor"),r(s,"stroke-width","4"),r(t,"class","opacity-75"),r(t,"fill","currentColor"),r(t,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(e,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24")},m(l,i){L(l,e,i),m(e,s),m(e,t)},d(l){l&&u(e)}}}function ye(n){let e,s,t,l;return{c(){e=k("button"),s=V("svg"),t=V("circle"),l=V("path"),this.h()},l(i){e=y(i,"BUTTON",{class:!0});var o=p(e);s=U(o,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var a=p(s);t=U(a,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(t).forEach(u),l=U(a,"path",{class:!0,fill:!0,d:!0}),p(l).forEach(u),a.forEach(u),o.forEach(u),this.h()},h(){r(t,"class","opacity-25"),r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(t,"stroke","currentColor"),r(t,"stroke-width","4"),r(l,"class","opacity-75"),r(l,"fill","currentColor"),r(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(s,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(s,"xmlns","http://www.w3.org/2000/svg"),r(s,"fill","none"),r(s,"viewBox","0 0 24 24"),r(e,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(i,o){L(i,e,o),m(e,s),m(s,t),m(s,l)},d(i){i&&u(e)}}}function Ee(n){let e,s,t;function l(a,d){return a[3]?He:Fe}let i=l(n),o=i(n);return{c(){e=k("button"),o.c(),this.h()},l(a){e=y(a,"BUTTON",{class:!0});var d=p(e);o.l(d),d.forEach(u),this.h()},h(){r(e,"class","text-white rounded-full h-14 w-14 bg-blue-700 grid place-items-center")},m(a,d){L(a,e,d),o.m(e,null),s||(t=re(e,"click",n[8]),s=!0)},p(a,d){i!==(i=l(a))&&(o.d(1),o=i(a),o&&(o.c(),o.m(e,null)))},d(a){a&&u(e),o.d(),s=!1,t()}}}function Fe(n){let e,s;return{c(){e=V("svg"),s=V("path"),this.h()},l(t){e=U(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var l=p(e);s=U(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),p(s).forEach(u),l.forEach(u),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M5 13l4 4L19 7"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"class","h-8 w-8"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24"),r(e,"stroke","currentColor")},m(t,l){L(t,e,l),m(e,s)},d(t){t&&u(e)}}}function He(n){let e,s,t;return{c(){e=V("svg"),s=V("circle"),t=V("path"),this.h()},l(l){e=U(l,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0});var i=p(e);s=U(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0}),p(s).forEach(u),t=U(i,"path",{class:!0,fill:!0,d:!0}),p(t).forEach(u),i.forEach(u),this.h()},h(){r(s,"class","opacity-25"),r(s,"cx","12"),r(s,"cy","12"),r(s,"r","10"),r(s,"stroke","currentColor"),r(s,"stroke-width","4"),r(t,"class","opacity-75"),r(t,"fill","currentColor"),r(t,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),r(e,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),r(e,"xmlns","http://www.w3.org/2000/svg"),r(e,"fill","none"),r(e,"viewBox","0 0 24 24")},m(l,i){L(l,e,i),m(e,s),m(e,t)},d(l){l&&u(e)}}}function Je(n){let e,s,t,l,i,o,a,d,z,I,F,H,C,K,A,f=n[4][n[0]]&&ve(n);return{c(){e=k("div"),s=k("h3"),t=de("Code Notes"),l=J(),i=k("div"),o=k("div"),a=k("div"),d=k("input"),z=J(),I=k("button"),F=de("Submit"),H=J(),f&&f.c(),this.h()},l(b){e=y(b,"DIV",{class:!0});var S=p(e);s=y(S,"H3",{class:!0});var h=p(s);t=he(h,"Code Notes"),h.forEach(u),S.forEach(u),l=P(b),i=y(b,"DIV",{class:!0});var E=p(i);o=y(E,"DIV",{class:!0});var _=p(o);a=y(_,"DIV",{class:!0});var g=p(a);d=y(g,"INPUT",{type:!0}),z=P(g),I=y(g,"BUTTON",{class:!0});var G=p(I);F=he(G,"Submit"),G.forEach(u),g.forEach(u),H=P(_),f&&f.l(_),_.forEach(u),E.forEach(u),this.h()},h(){r(s,"class","ml-10"),r(e,"class","fixed inset-x-0 p-2 md:p-4 bg-gray-700 md:top-0 top-14 text-white text-lg md:pl-64 z-10"),r(d,"type","file"),r(I,"class","px-4 py-2 bg-indigo-200 text-indigo-900 hover:bg-indigo-300 transition"),r(a,"class","border-4 border-dotted border-indigo-200 p-6 rounded-lg"),r(o,"class","container mx-auto max-w-screen-md "),r(i,"class","section md:mt-8 mt-12")},m(b,S){L(b,e,S),m(e,s),m(s,t),L(b,l,S),L(b,i,S),m(i,o),m(o,a),m(a,d),n[13](d),m(a,z),m(a,I),m(I,F),m(o,H),f&&f.m(o,null),C=!0,K||(A=re(I,"click",n[9]),K=!0)},p(b,[S]){b[4][b[0]]?f?(f.p(b,S),S&17&&B(f,1)):(f=ve(b),f.c(),B(f,1),f.m(o,null)):f&&(ie(),M(f,1,1,()=>{f=null}),le())},i(b){C||(B(f),C=!0)},o(b){M(f),C=!1},d(b){b&&u(e),b&&u(l),b&&u(i),n[13](null),f&&f.d(),K=!1,A()}}}async function ot({page:n,fetch:e,session:s}){if(!s)return{status:302,redirect:"/auth"};let t=n.params.index,l=t.split("-"),i=+l[0];+l[1];let o;if(l.length>1){const a=await e(`/code/${t}.json`),d=await a.json();o=JSON.parse(d.string),a.status===200}return{props:{i,session:s,post:o,slug:t}}}let Pe=!0;function Ae(n,e,s){let t,l;me(n,W,h=>s(4,t=h)),me(n,X,h=>s(5,l=h));let{i=0}=e,{post:o}=e,{slug:a}=e,d,z=!1,I=!1,{session:F}=e;Te(()=>{console.log("SLUG: ",a),"caches"in window&&Le(o,a).then(h=>s(10,o=h))});function H(){t[i]===void 0&&o!==void 0?x(W,t[i]=o,t):t[i]?console.log("new"):(console.log("ELSING"),browser&&ne("/code",{invalidate:!0}))}H();function C(){x(X,l.update=!1,l),t.forEach(h=>{h.edit=!1,h.steps.length>0&&h.steps.forEach(E=>{E.editDesc=!1,E.editCode=!1})})}function K(){let h={title:"",steps:[],edit:!0,ready:!0,mode:"draft"};x(W,t=[...t,h],t),x(X,l.showFabs=!0,l),x(X,l.save=!0,l),x(X,l.edit=!1,l);let E=t.length-1;ne("/code/"+E)}async function A(){s(2,z=!0),x(X,l.update=!1,l),x(W,t[i].mode="publish",t);let h=t[i],E={title:t[i].title,string:JSON.stringify(h),status:"publish",author:F.id};const g=await(await fetch(`/code/${a}}.json`,{method:"POST",body:JSON.stringify(E)})).json();setTimeout(()=>{C(),x(W,t.ready=!0,t),x(X,l.save=!1,l),x(X,l.update=!1,l),ne(`/code/${i}-${g.body.id}`,{replaceState:!0})},2001)}async function f(){s(3,I=!0),x(W,t[i].mode="publish",t);let h=t[i],E={title:t[i].title,string:JSON.stringify(h),status:"publish",author:F.id};console.log(t[i].id),await(await fetch(`/code/${t[i].id}.json`,{method:"PUT",body:JSON.stringify(E)})).json(),s(3,I=!1),x(X,l.update=!1,l)}l.save||C();async function b(){const h=new FormData;h.append("file",d.files[0]);try{const E=await fetch(`/code/media/${t[i].id}`,{method:"POST",body:JSON.stringify(h)});console.log(E)}catch(E){console.error(E)}}function S(h){Ie[h?"unshift":"push"](()=>{d=h,s(1,d)})}return n.$$set=h=>{"i"in h&&s(0,i=h.i),"post"in h&&s(10,o=h.post),"slug"in h&&s(11,a=h.slug),"session"in h&&s(12,F=h.session)},n.$$.update=()=>{n.$$.dirty&2},[i,d,z,I,t,l,K,A,f,b,o,a,F,S]}class nt extends Be{constructor(e){super();Ce(this,e,Ae,Je,Se,{i:0,post:10,slug:11,session:12})}}export{nt as default,ot as load};
