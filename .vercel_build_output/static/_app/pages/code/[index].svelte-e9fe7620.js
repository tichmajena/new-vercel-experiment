import{S as t,i as s,s as e,e as l,k as o,j as r,c as n,a as i,d as a,n as c,m as h,b as d,f,F as u,o as m,v as p,r as v,w as g,u as w,D as x,G as k,H as $,U as b,t as E,g as j,J as y,B as C,K as B}from"../../chunks/vendor-d62291b3.js";import{c as D,d as V}from"../../chunks/store-0291cfd6.js";import I from"./NoteBody.svelte-8a4d1c63.js";import N from"./TitleForm.svelte-e914bfbf.js";import T from"./TitleContent.svelte-b1acbaaa.js";import O from"./OurButtons.svelte-5689548c.js";import{g as S}from"../../chunks/navigation-0819b7b8.js";import"./CodeContent.svelte-de560a7d.js";import"../../chunks/preload-helper-9f12a5fd.js";import"./CodeForm.svelte-98fff98f.js";import"./DescriptionForm.svelte-d1b219e5.js";import"./DescriptionContent.svelte-109fd435.js";import"../../chunks/index-130bfc23.js";import"./QuillCode.svelte-f69c1474.js";import"../../chunks/singletons-9c431dc7.js";function z(t,s,e){const l=t.slice();return l[12]=s[e],l[14]=e,l}function H(t){let s,e,x,k,$,E,j,y,B,D,V,I,N,T,S,H,F,A,K,Q,q=t[3][t[0]].edit&&J(t),R=!t[3][t[0]].edit&&L(t),X=t[3][t[0]].steps,Y=[];for(let l=0;l<X.length;l+=1)Y[l]=M(z(t,X,l));const Z=t=>v(Y[t],1,1,(()=>{Y[t]=null}));let tt=!W;N=new O({props:{i:t[0]}});let st=!t[4].save&&!t[4].update&&U(t),et=t[4].save&&"draft"===t[3][t[0]].mode&&_(t),lt=t[4].save&&"publish"===t[3][t[0]].mode&&G(),ot=t[4].update&&"publish"===t[3][t[0]].mode&&P(t);return{c(){s=l("div"),e=l("div"),x=l("div"),k=l("div"),q&&q.c(),$=o(),E=l("div"),R&&R.c(),j=o(),y=l("div"),B=l("ol");for(let t=0;t<Y.length;t+=1)Y[t].c();D=o(),V=o(),I=l("div"),r(N.$$.fragment),T=o(),S=l("div"),H=l("div"),st&&st.c(),F=o(),et&&et.c(),A=o(),lt&&lt.c(),K=o(),ot&&ot.c(),this.h()},l(t){s=n(t,"DIV",{class:!0});var l=i(s);e=n(l,"DIV",{class:!0});var o=i(e);x=n(o,"DIV",{class:!0});var r=i(x);k=n(r,"DIV",{class:!0});var d=i(k);q&&q.l(d),d.forEach(a),$=c(r),E=n(r,"DIV",{class:!0});var f=i(E);R&&R.l(f),f.forEach(a),r.forEach(a),o.forEach(a),j=c(l),y=n(l,"DIV",{class:!0});var u=i(y);B=n(u,"OL",{class:!0});var m=i(B);for(let s=0;s<Y.length;s+=1)Y[s].l(m);m.forEach(a),D=c(u),u.forEach(a),V=c(l),I=n(l,"DIV",{class:!0});var p=i(I);h(N.$$.fragment,p),p.forEach(a),T=c(l),S=n(l,"DIV",{class:!0});var v=i(S);H=n(v,"DIV",{id:!0});var g=i(H);st&&st.l(g),F=c(g),et&&et.l(g),A=c(g),lt&&lt.l(g),K=c(g),ot&&ot.l(g),g.forEach(a),v.forEach(a),l.forEach(a),this.h()},h(){d(k,"class","title__form-div"),d(E,"class","title__content-div"),d(x,"class","note-title__title"),d(e,"class","note-title"),d(B,"class","list-decimal"),d(y,"class","note-body"),d(I,"class","note-footer"),d(H,"id","add-btn"),d(S,"class","bottom-bar md:pl-64"),d(s,"class","app-wrapper svelte-18ehxgn")},m(t,l){f(t,s,l),u(s,e),u(e,x),u(x,k),q&&q.m(k,null),u(x,$),u(x,E),R&&R.m(E,null),u(s,j),u(s,y),u(y,B);for(let s=0;s<Y.length;s+=1)Y[s].m(B,null);u(y,D),u(s,V),u(s,I),m(N,I,null),u(s,T),u(s,S),u(S,H),st&&st.m(H,null),u(H,F),et&&et.m(H,null),u(H,A),lt&&lt.m(H,null),u(H,K),ot&&ot.m(H,null),Q=!0},p(t,s){if(t[3][t[0]].edit?q?(q.p(t,s),9&s&&p(q,1)):(q=J(t),q.c(),p(q,1),q.m(k,null)):q&&(C(),v(q,1,1,(()=>{q=null})),w()),t[3][t[0]].edit?R&&(C(),v(R,1,1,(()=>{R=null})),w()):R?(R.p(t,s),9&s&&p(R,1)):(R=L(t),R.c(),p(R,1),R.m(E,null)),9&s){let e;for(X=t[3][t[0]].steps,e=0;e<X.length;e+=1){const l=z(t,X,e);Y[e]?(Y[e].p(l,s),p(Y[e],1)):(Y[e]=M(l),Y[e].c(),p(Y[e],1),Y[e].m(B,null))}for(C(),e=X.length;e<Y.length;e+=1)Z(e);w()}const e={};1&s&&(e.i=t[0]),N.$set(e),t[4].save||t[4].update?st&&(st.d(1),st=null):st?st.p(t,s):(st=U(t),st.c(),st.m(H,F)),t[4].save&&"draft"===t[3][t[0]].mode?et?et.p(t,s):(et=_(t),et.c(),et.m(H,A)):et&&(et.d(1),et=null),t[4].save&&"publish"===t[3][t[0]].mode?lt||(lt=G(),lt.c(),lt.m(H,K)):lt&&(lt.d(1),lt=null),t[4].update&&"publish"===t[3][t[0]].mode?ot?ot.p(t,s):(ot=P(t),ot.c(),ot.m(H,null)):ot&&(ot.d(1),ot=null)},i(t){if(!Q){p(q),p(R);for(let t=0;t<X.length;t+=1)p(Y[t]);p(tt),p(N.$$.fragment,t),Q=!0}},o(t){v(q),v(R),Y=Y.filter(Boolean);for(let s=0;s<Y.length;s+=1)v(Y[s]);v(tt),v(N.$$.fragment,t),Q=!1},d(t){t&&a(s),q&&q.d(),R&&R.d(),b(Y,t),g(N),st&&st.d(),et&&et.d(),lt&&lt.d(),ot&&ot.d()}}}function J(t){let s,e;return s=new N({props:{i:t[0]}}),{c(){r(s.$$.fragment)},l(t){h(s.$$.fragment,t)},m(t,l){m(s,t,l),e=!0},p(t,e){const l={};1&e&&(l.i=t[0]),s.$set(l)},i(t){e||(p(s.$$.fragment,t),e=!0)},o(t){v(s.$$.fragment,t),e=!1},d(t){g(s,t)}}}function L(t){let s,e;return s=new T({props:{i:t[0]}}),{c(){r(s.$$.fragment)},l(t){h(s.$$.fragment,t)},m(t,l){m(s,t,l),e=!0},p(t,e){const l={};1&e&&(l.i=t[0]),s.$set(l)},i(t){e||(p(s.$$.fragment,t),e=!0)},o(t){v(s.$$.fragment,t),e=!1},d(t){g(s,t)}}}function M(t){let s,e,w,x;return e=new I({props:{i:t[0],ii:t[14]}}),{c(){s=l("li"),r(e.$$.fragment),w=o(),this.h()},l(t){s=n(t,"LI",{class:!0});var l=i(s);h(e.$$.fragment,l),w=c(l),l.forEach(a),this.h()},h(){d(s,"class","mb-5")},m(t,l){f(t,s,l),m(e,s,null),u(s,w),x=!0},p(t,s){const l={};1&s&&(l.i=t[0]),e.$set(l)},i(t){x||(p(e.$$.fragment,t),x=!0)},o(t){v(e.$$.fragment,t),x=!1},d(t){t&&a(s),g(e)}}}function U(t){let s,e,o,r,c;return{c(){s=l("button"),e=x("svg"),o=x("path"),this.h()},l(t){s=n(t,"BUTTON",{class:!0});var l=i(s);e=n(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0},1);var r=i(e);o=n(r,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0},1),i(o).forEach(a),r.forEach(a),l.forEach(a),this.h()},h(){d(o,"stroke-linecap","round"),d(o,"stroke-linejoin","round"),d(o,"stroke-width","2"),d(o,"d","M12 6v6m0 0v6m0-6h6m-6 0H6"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"class","h-8 w-8"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(e,"stroke","currentColor"),d(s,"class","text-white rounded-full h-14 w-14 bg-pink-700 grid place-items-center")},m(l,n){f(l,s,n),u(s,e),u(e,o),r||(c=k(s,"click",t[5]),r=!0)},p:$,d(t){t&&a(s),r=!1,c()}}}function _(t){let s,e,o;function r(t,s){return t[1]?A:F}let c=r(t),h=c(t);return{c(){s=l("button"),h.c(),this.h()},l(t){s=n(t,"BUTTON",{class:!0});var e=i(s);h.l(e),e.forEach(a),this.h()},h(){d(s,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(l,r){f(l,s,r),h.m(s,null),e||(o=k(s,"click",t[6]),e=!0)},p(t,e){c!==(c=r(t))&&(h.d(1),h=c(t),h&&(h.c(),h.m(s,null)))},d(t){t&&a(s),h.d(),e=!1,o()}}}function F(t){let s,e;return{c(){s=x("svg"),e=x("path"),this.h()},l(t){s=n(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0},1);var l=i(s);e=n(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0},1),i(e).forEach(a),l.forEach(a),this.h()},h(){d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"stroke-width","2"),d(e,"d","M5 13l4 4L19 7"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"class","h-8 w-8"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24"),d(s,"stroke","currentColor")},m(t,l){f(t,s,l),u(s,e)},d(t){t&&a(s)}}}function A(t){let s,e,l;return{c(){s=x("svg"),e=x("circle"),l=x("path"),this.h()},l(t){s=n(t,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0},1);var o=i(s);e=n(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0},1),i(e).forEach(a),l=n(o,"path",{class:!0,fill:!0,d:!0},1),i(l).forEach(a),o.forEach(a),this.h()},h(){d(e,"class","opacity-25"),d(e,"cx","12"),d(e,"cy","12"),d(e,"r","10"),d(e,"stroke","currentColor"),d(e,"stroke-width","4"),d(l,"class","opacity-75"),d(l,"fill","currentColor"),d(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),d(s,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24")},m(t,o){f(t,s,o),u(s,e),u(s,l)},d(t){t&&a(s)}}}function G(t){let s,e,o,r;return{c(){s=l("button"),e=x("svg"),o=x("circle"),r=x("path"),this.h()},l(t){s=n(t,"BUTTON",{class:!0});var l=i(s);e=n(l,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0},1);var c=i(e);o=n(c,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0},1),i(o).forEach(a),r=n(c,"path",{class:!0,fill:!0,d:!0},1),i(r).forEach(a),c.forEach(a),l.forEach(a),this.h()},h(){d(o,"class","opacity-25"),d(o,"cx","12"),d(o,"cy","12"),d(o,"r","10"),d(o,"stroke","currentColor"),d(o,"stroke-width","4"),d(r,"class","opacity-75"),d(r,"fill","currentColor"),d(r,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),d(e,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"fill","none"),d(e,"viewBox","0 0 24 24"),d(s,"class","text-white rounded-full h-14 w-14 bg-green-700 flex items-center justify-center")},m(t,l){f(t,s,l),u(s,e),u(e,o),u(e,r)},d(t){t&&a(s)}}}function P(t){let s,e,o;function r(t,s){return t[2]?Q:K}let c=r(t),h=c(t);return{c(){s=l("button"),h.c(),this.h()},l(t){s=n(t,"BUTTON",{class:!0});var e=i(s);h.l(e),e.forEach(a),this.h()},h(){d(s,"class","text-white rounded-full h-14 w-14 bg-blue-700 grid place-items-center")},m(l,r){f(l,s,r),h.m(s,null),e||(o=k(s,"click",t[7]),e=!0)},p(t,e){c!==(c=r(t))&&(h.d(1),h=c(t),h&&(h.c(),h.m(s,null)))},d(t){t&&a(s),h.d(),e=!1,o()}}}function K(t){let s,e;return{c(){s=x("svg"),e=x("path"),this.h()},l(t){s=n(t,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0},1);var l=i(s);e=n(l,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0},1),i(e).forEach(a),l.forEach(a),this.h()},h(){d(e,"stroke-linecap","round"),d(e,"stroke-linejoin","round"),d(e,"stroke-width","2"),d(e,"d","M5 13l4 4L19 7"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"class","h-8 w-8"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24"),d(s,"stroke","currentColor")},m(t,l){f(t,s,l),u(s,e)},d(t){t&&a(s)}}}function Q(t){let s,e,l;return{c(){s=x("svg"),e=x("circle"),l=x("path"),this.h()},l(t){s=n(t,"svg",{class:!0,xmlns:!0,fill:!0,viewBox:!0},1);var o=i(s);e=n(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0},1),i(e).forEach(a),l=n(o,"path",{class:!0,fill:!0,d:!0},1),i(l).forEach(a),o.forEach(a),this.h()},h(){d(e,"class","opacity-25"),d(e,"cx","12"),d(e,"cy","12"),d(e,"r","10"),d(e,"stroke","currentColor"),d(e,"stroke-width","4"),d(l,"class","opacity-75"),d(l,"fill","currentColor"),d(l,"d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"),d(s,"class","animate-spin mx-auro h-8 w-8 text-white text-center"),d(s,"xmlns","http://www.w3.org/2000/svg"),d(s,"fill","none"),d(s,"viewBox","0 0 24 24")},m(t,o){f(t,s,o),u(s,e),u(s,l)},d(t){t&&a(s)}}}function q(t){let s,e,r,h,m,g,x,k=t[3][t[0]]&&H(t);return{c(){s=l("div"),e=l("h3"),r=E("Code Notes"),h=o(),m=l("div"),g=l("div"),k&&k.c(),this.h()},l(t){s=n(t,"DIV",{class:!0});var l=i(s);e=n(l,"H3",{class:!0});var o=i(e);r=j(o,"Code Notes"),o.forEach(a),l.forEach(a),h=c(t),m=n(t,"DIV",{class:!0});var d=i(m);g=n(d,"DIV",{class:!0});var f=i(g);k&&k.l(f),f.forEach(a),d.forEach(a),this.h()},h(){d(e,"class","ml-10"),d(s,"class","fixed inset-x-0 p-2 md:p-4 bg-gray-700 md:top-0 top-14 text-white text-lg md:pl-64 z-10"),d(g,"class","container mx-auto max-w-screen-md "),d(m,"class","section md:mt-8 mt-12")},m(t,l){f(t,s,l),u(s,e),u(e,r),f(t,h,l),f(t,m,l),u(m,g),k&&k.m(g,null),x=!0},p(t,[s]){t[3][t[0]]?k?(k.p(t,s),9&s&&p(k,1)):(k=H(t),k.c(),p(k,1),k.m(g,null)):k&&(C(),v(k,1,1,(()=>{k=null})),w())},i(t){x||(p(k),x=!0)},o(t){v(k),x=!1},d(t){t&&a(s),t&&a(h),t&&a(m),k&&k.d()}}}async function R({page:t,fetch:s,session:e}){if(!e)return{status:302,redirect:"/auth"};let l=t.params.index.split("-"),o=+l[0];console.log(l);let r,n=+l[1];if(l.length>1){const t=await s(`/code/${n}.json`),e=await t.json();r=JSON.parse(e.string),200===t.status&&console.log(r),console.log(t)}return{props:{i:o,session:e,post:r}}}let W=!0;function X(t,s,e){let l,o;y(t,D,(t=>e(3,l=t))),y(t,V,(t=>e(4,o=t)));let{i:r=0}=s,{post:n}=s,i=!1,a=!1,{session:c}=s;function h(){B(V,o.update=!1,o),l.forEach((t=>{t.edit=!1,t.steps.length>0&&t.steps.forEach((t=>{t.editDesc=!1,t.editCode=!1}))}))}return console.log("Logging codenotes",l[r]),void 0===l[r]&&void 0!==n?B(D,l[r]=n,l):l[r]?console.log("new"):(console.log("ELSING",n),S("/code",{invalidate:!0})),o.save||h(),t.$$set=t=>{"i"in t&&e(0,r=t.i),"post"in t&&e(8,n=t.post),"session"in t&&e(9,c=t.session)},[r,i,a,l,o,function(){B(D,l=[...l,{title:"",steps:[],edit:!0,ready:!0,mode:"draft"}],l),B(V,o.showFabs=!0,o),B(V,o.save=!0,o),B(V,o.edit=!1,o);let t=l.length-1;S("/code/"+t)},async function(){e(1,i=!0),B(V,o.update=!1,o),B(D,l[r].mode="publish",l);let t=l[r],s={title:l[r].title,string:JSON.stringify(t),status:"publish",author:c.id};const n=await fetch(`/code/${r}.json`,{method:"POST",body:JSON.stringify(s)}),a=await n.json();setTimeout((()=>{h(),B(D,l.ready=!0,l),B(V,o.save=!1,o),B(V,o.update=!1,o),S(`/code/${r}-${a.body.id}`,{replaceState:!0})}),2001)},async function(){e(2,a=!0),B(D,l[r].mode="publish",l);let t=l[r],s={title:l[r].title,string:JSON.stringify(t),status:"publish",author:c.id};console.log(l[r].id);const n=await fetch(`/code/${l[r].id}.json`,{method:"PUT",body:JSON.stringify(s)}),i=await n.json();console.log(n),console.log(i),e(2,a=!1),B(V,o.update=!1,o)},n,c]}export default class extends t{constructor(t){super(),s(this,t,X,q,e,{i:0,post:8,session:9})}}export{R as load};
