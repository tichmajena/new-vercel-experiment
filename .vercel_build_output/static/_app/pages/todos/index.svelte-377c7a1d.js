import{S as ee,i as te,s as ae,e as g,k as U,c as E,a as w,n as D,d as k,b as o,F as X,f as H,G as _,_ as V,a0 as J,a1 as oe,a2 as ne,a3 as le,T as se,a4 as Y,J as re,t as ie,R as ue,g as ce,a5 as de,w as fe,x as _e,u as he,a6 as pe,V as Z,r as ve,a7 as me,I as be}from"../../chunks/vendor-52b416c4.js";function q(u,{pending:t,error:e,result:a}){let h;async function j(p){const d=h={};p.preventDefault();const c=new FormData(u);t&&t(c,u);try{const i=await fetch(u.action,{method:u.method,headers:{accept:"application/json"},body:c});if(d!==h)return;i.ok?a(i,u):e?e(i,null,u):console.error(await i.text())}catch(i){if(e)e(null,i,u);else throw i}}return u.addEventListener("submit",j),{destroy(){u.removeEventListener("submit",j)}}}function $(u,t,e){const a=u.slice();return a[5]=t[e],a[6]=t,a[7]=e,a}function x(u,t){let e,a,h,j,p,d,c,i,l,F,v,m,I,y,M,s,r,n,O,B,N,C,R,L,A=be,T,G,z;function K(...b){return t[3](t[5],t[6],t[7],...b)}function Q(){return t[4](t[5])}return{key:u,first:null,c(){e=g("div"),a=g("form"),h=g("input"),p=U(),d=g("button"),F=U(),v=g("form"),m=g("input"),y=U(),M=g("button"),r=U(),n=g("form"),O=g("button"),C=U(),this.h()},l(b){e=E(b,"DIV",{class:!0});var f=w(e);a=E(f,"FORM",{action:!0,method:!0});var P=w(a);h=E(P,"INPUT",{type:!0,name:!0,class:!0}),p=D(P),d=E(P,"BUTTON",{class:!0,"aria-label":!0}),w(d).forEach(k),P.forEach(k),F=D(f),v=E(f,"FORM",{class:!0,action:!0,method:!0});var S=w(v);m=E(S,"INPUT",{"aria-label":!0,type:!0,name:!0,class:!0}),y=D(S),M=E(S,"BUTTON",{class:!0,"aria-label":!0}),w(M).forEach(k),S.forEach(k),r=D(f),n=E(f,"FORM",{action:!0,method:!0});var W=w(n);O=E(W,"BUTTON",{class:!0,"aria-label":!0}),w(O).forEach(k),W.forEach(k),C=D(f),f.forEach(k),this.h()},h(){o(h,"type","hidden"),o(h,"name","done"),h.value=j=t[5].done?"":"true",o(h,"class","svelte-16tkvjn"),o(d,"class","toggle svelte-16tkvjn"),o(d,"aria-label",c="Mark todo as "+(t[5].done?"not done":"done")),o(a,"action",i="/todos/"+t[5].uid+".json?_method=patch"),o(a,"method","post"),o(m,"aria-label","Edit todo"),o(m,"type","text"),o(m,"name","text"),m.value=I=t[5].text,o(m,"class","svelte-16tkvjn"),o(M,"class","save svelte-16tkvjn"),o(M,"aria-label","Save todo"),o(v,"class","text svelte-16tkvjn"),o(v,"action",s="/todos/"+t[5].uid+".json?_method=patch"),o(v,"method","post"),o(O,"class","delete svelte-16tkvjn"),o(O,"aria-label","Delete todo"),o(n,"action",B="/todos/"+t[5].uid+".json?_method=delete"),o(n,"method","post"),o(e,"class","todo svelte-16tkvjn"),X(e,"done",t[5].done),this.first=e},m(b,f){H(b,e,f),_(e,a),_(a,h),_(a,p),_(a,d),_(e,F),_(e,v),_(v,m),_(v,y),_(v,M),_(e,r),_(e,n),_(n,O),_(e,C),T=!0,G||(z=[V(l=q.call(null,a,{pending:K,result:t[1]})),V(q.call(null,v,{result:t[1]})),V(N=q.call(null,n,{result:Q}))],G=!0)},p(b,f){t=b,(!T||f&1&&j!==(j=t[5].done?"":"true"))&&(h.value=j),(!T||f&1&&c!==(c="Mark todo as "+(t[5].done?"not done":"done")))&&o(d,"aria-label",c),(!T||f&1&&i!==(i="/todos/"+t[5].uid+".json?_method=patch"))&&o(a,"action",i),l&&J(l.update)&&f&1&&l.update.call(null,{pending:K,result:t[1]}),(!T||f&1&&I!==(I=t[5].text)&&m.value!==I)&&(m.value=I),(!T||f&1&&s!==(s="/todos/"+t[5].uid+".json?_method=patch"))&&o(v,"action",s),(!T||f&1&&B!==(B="/todos/"+t[5].uid+".json?_method=delete"))&&o(n,"action",B),N&&J(N.update)&&f&1&&N.update.call(null,{result:Q}),f&1&&X(e,"done",t[5].done)},r(){L=e.getBoundingClientRect()},f(){oe(e),A(),ne(e,L)},a(){A(),A=le(e,L,pe,{duration:200})},i(b){T||(b&&se(()=>{R||(R=Y(e,Z,{start:.7},!0)),R.run(1)}),T=!0)},o(b){b&&(R||(R=Y(e,Z,{start:.7},!1)),R.run(0)),T=!1},d(b){b&&k(e),b&&R&&R.end(),G=!1,re(z)}}}function ke(u){let t,e,a,h,j,p,d,c,i,l=[],F=new Map,v,m,I,y=u[0];const M=s=>s[5].uid;for(let s=0;s<y.length;s+=1){let r=$(u,y,s),n=M(r);F.set(n,l[s]=x(n,r))}return{c(){t=U(),e=g("div"),a=g("h1"),h=ie("Todos"),j=U(),p=g("form"),d=g("input"),i=U();for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){ue('[data-svelte="svelte-181o7gf"]',document.head).forEach(k),t=D(s),e=E(s,"DIV",{class:!0});var n=w(e);a=E(n,"H1",{});var O=w(a);h=ce(O,"Todos"),O.forEach(k),j=D(n),p=E(n,"FORM",{class:!0,action:!0,method:!0});var B=w(p);d=E(B,"INPUT",{name:!0,"aria-label":!0,placeholder:!0,class:!0}),B.forEach(k),i=D(n);for(let N=0;N<l.length;N+=1)l[N].l(n);n.forEach(k),this.h()},h(){document.title="Todos",o(d,"name","text"),o(d,"aria-label","Add todo"),o(d,"placeholder","+ tap to add a todo"),o(d,"class","svelte-16tkvjn"),o(p,"class","new svelte-16tkvjn"),o(p,"action","/todos.json"),o(p,"method","post"),o(e,"class","todos svelte-16tkvjn")},m(s,r){H(s,t,r),H(s,e,r),_(e,a),_(a,h),_(e,j),_(e,p),_(p,d),_(e,i);for(let n=0;n<l.length;n+=1)l[n].m(e,null);v=!0,m||(I=V(c=q.call(null,p,{result:u[2]})),m=!0)},p(s,[r]){if(c&&J(c.update)&&r&1&&c.update.call(null,{result:s[2]}),r&3){y=s[0],ve();for(let n=0;n<l.length;n+=1)l[n].r();l=de(l,r,M,1,s,y,F,e,me,x,null,$);for(let n=0;n<l.length;n+=1)l[n].a();fe()}},i(s){if(!v){for(let r=0;r<y.length;r+=1)_e(l[r]);v=!0}},o(s){for(let r=0;r<l.length;r+=1)he(l[r]);v=!1},d(s){s&&k(t),s&&k(e);for(let r=0;r<l.length;r+=1)l[r].d();m=!1,I()}}}const Ee=async({fetch:u})=>{const t=await u("/todos.json");if(t.ok)return{props:{todos:await t.json()}};const{message:e}=await t.json();return{error:new Error(e)}};function je(u,t,e){let{todos:a}=t;async function h(c){const i=await c.json();e(0,a=a.map(l=>l.uid===i.uid?i:l))}const j=async(c,i)=>{const l=await c.json();e(0,a=[...a,l]),i.reset()},p=(c,i,l,F)=>{e(0,i[l].done=!!F.get("done"),a)},d=c=>{e(0,a=a.filter(i=>i.uid!==c.uid))};return u.$$set=c=>{"todos"in c&&e(0,a=c.todos)},[a,h,j,p,d]}class Te extends ee{constructor(t){super();te(this,t,je,ke,ae,{todos:0})}}export{Te as default,Ee as load};
